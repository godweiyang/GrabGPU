# 抢占显卡脚本


## 编译方法

```shell
nvcc gg.cu -o gg
```

## 抢占到显卡后自动执行默认脚本
**使用方法：**  
```shell
./gg <占用显存 (GB)> <占用时间(h)> <显卡序号> <显卡利用率 (0.0-1.0)>
```

**举例：**  
抢占 16 GB 显存 24 小时，使用 GPU 0, 1, 2, 3 来运行默认脚本，显卡利用率控制在50%左右。
```shell
./gg 16 24 0,1,2,3 0.5
```

**注意：**
如果显卡利用率不符合预期，请检查输出日志中 `Last Kernel Duration: xx.xxx ms` 显示的时间是否在20-100ms之间，不在的话请修改 `gg.cu` 中下面这行，调整循环次数。
``` c++
for (int k = 0; k < 2000; ++k) {
```

## 抢占到显卡后自动执行自定义程序（比如训练模型）
**使用方法：**  
```shell
./gg <占用显存 (GB)> <占用时间 (h)> <显卡序号> <显卡利用率 (0.0-1.0)> <自定义脚本路径（.sh文件）>
```

**举例：**  
抢占 16 GB 显存 24 小时，使用 GPU 0, 1, 2, 3 来运行自定义脚本 `run.sh`。注意这里的占用时间和显卡利用率都是无效的，会直到自定义脚本执行完毕才释放显卡。
```shell
./gg 16 24 0,1,2,3 0.5 run.sh
```
